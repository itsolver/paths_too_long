# paths_too_long Toolset

This toolset is designed to address filepaths that exceed the 260 character limit typically found in Windows file servers. It can be particularly useful for migrating file shares to SharePoint. The toolset comprises three scripts, each with a specific function:

### paths_too_long.py

`paths_too_long.py` is a straightforward script that operates in the console. It prompts the user to input a path to scan and then iterates through the directories within that path, collecting information about the files. It populates a dataframe with file attributes and removes files with path lengths under 260 characters. The resulting dataframe is saved as a CSV file.

### fix_paths2long.py

`fix_paths2long.py` launches a graphical user interface (GUI) using data generated by `paths_too_long.py`. It collects user-driven corrections for directory names to shorten path lengths. To start, it requests the name of the CSV file, which should be in the same directory as `fix_paths2long.py`. From the CSV file, it creates a dataframe and iterates through each row, creating a tkinter frame for each path, referred to as the ChooseSegmentFrame.

The ChooseSegmentFrame includes four rows:

1. The entire path.
2. Buttons corresponding to each directory in the path.
3. The number of other file paths sharing each directory in the path, aiding batch changes.
4. The length of the longest filepath from the dataframe including the corresponding directory.

Selecting a directory button from row 2 generates the next frame, the FixSegmentFrame, where users can make desired changes to the directory name. The changes are saved for all affected file paths in the dataframe. The 'write changes to csv' button on the FixSegmentFrame frame saves the updated dataframe to the CSV file, effectively saving the user's progress.

### apply_file2long_fixes.py

This script executes the directory and file name changes recorded in `fix_paths2long.py`. It begins by requesting the name of the CSV file generated by `paths_too_long.py` with corrections from `fix_paths2long.py`. The CSV file should be in the same directory as the script. The script processes the dataframe from the CSV file, adding a 'depth' attribute, which represents the number of directories between the directory changed in `fix_paths2long.py` and the root.

Starting with file paths requiring the deepest directory or file name changes, the script iterates through the dataframe, making the necessary changes and recording them in an 'intermediary_paths' column. The latest filepath change is recorded in the 'result_path' column. Any errors encountered during path location or modification are recorded in the 'error' column. The resulting dataframe contains a list of all filepath changes in the 'intermediary_paths' column, with the actual file locations in the 'result_path' column. This dataframe is then saved to a CSV file.
